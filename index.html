<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Data Privacy & Civic Decisions | Interactive Explorer</title>
    <meta name="description" content="Explore how differential privacy in census data creates real uncertainty affecting schools, hospitals, and political representation.">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700&family=Source+Sans+3:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/enhanced.css">
    <link rel="stylesheet" href="css/scenarios.css">
    <link rel="stylesheet" href="css/components.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="atmosphere"></div>
    <div class="grid-pattern"></div>
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="badge animate-in">
                ğŸ“ Jahidul Arafat â€” | Former Senior Solution Architect at Oracle
            </div>

            <h1 class="title animate-in delay-1">
                The Hidden Cost of <span class="highlight">Data Privacy</span>
            </h1>

            <p class="subtitle animate-in delay-2">
                Understanding how DP noise and data fragility introduce uncertainty into critical civic decision-making.
            </p>
        </header>


        <!-- Introduction -->
        <section class="intro-section animate-in delay-3">
            <div class="intro-grid">
                <div class="intro-content">
                    <h2><span class="icon">ğŸ¤”</span> What's the Problem?</h2>
                    <p>Every 10 years, the U.S. Census counts every person in America. This data decides <strong>who gets funding</strong>, <strong>where hospitals are built</strong>, and <strong>how many representatives your state gets in Congress</strong>.</p>
                    <p>But here's the dilemma: Publishing exact numbers could reveal private information about individuals.</p>
                    <div class="key-concept">
                        <div class="key-concept-label">ğŸ’¡ The Core Tradeoff</div>
                        <p>To protect privacy, the Census Bureau adds <em>random noise</em> to the data before publishing. This is called <strong>Differential Privacy (DP)</strong>. More privacy protection = more noise = less accurate numbers.</p>
                    </div>
                </div>
                <div class="real-world-box">
                    <h3>ğŸ“Š Where This Data Comes From</h3>
                    <div class="data-source"><div class="data-source-icon">ğŸ›ï¸</div><div class="data-source-info"><h4>U.S. Census Bureau</h4><p>Decennial Census â€” First to use DP at scale</p></div></div>
                    <div class="data-source"><div class="data-source-icon">ğŸ“š</div><div class="data-source-info"><h4>Department of Education</h4><p>Title I funding allocation</p></div></div>
                    <div class="data-source"><div class="data-source-icon">ğŸ—³ï¸</div><div class="data-source-info"><h4>State Legislatures</h4><p>Congressional redistricting</p></div></div>
                    <div class="data-source"><div class="data-source-icon">ğŸ¥</div><div class="data-source-info"><h4>HRSA</h4><p>Rural health clinic approvals</p></div></div>
                </div>
            </div>
        </section>
        
        <!-- Impact Cards -->
        <section class="why-matters animate-in">
            <div class="impact-card funding">
                <div class="impact-icon">ğŸ«</div>
                <h3>School Funding at Risk</h3>
                <p>Districts on the edge of Title I eligibility face uncertainty.</p>
                <div class="impact-stat"><span class="impact-stat-label">Districts near thresholds</span><span class="impact-stat-value">~2,400</span></div>
            </div>
            <div class="impact-card health">
                <div class="impact-icon">ğŸ¥</div>
                <h3>Healthcare Access Gaps</h3>
                <p>Small communities may be denied services based on noisy data.</p>
                <div class="impact-stat"><span class="impact-stat-label">Rural areas affected</span><span class="impact-stat-value">~1,800</span></div>
            </div>
            <div class="impact-card democracy">
                <div class="impact-icon">ğŸ—³ï¸</div>
                <h3>Representation Questions</h3>
                <p>Small errors could affect representation for millions.</p>
                <div class="impact-stat"><span class="impact-stat-label">Seats with close margins</span><span class="impact-stat-value">~12</span></div>
            </div>
        </section>
        
        <!-- Mode Tabs -->
        <nav class="mode-tabs">
            <div class="mode-tab-list">
                <button class="mode-tab active" data-mode="single">ğŸ“Š Single Scenario</button>
                <button class="mode-tab" data-mode="comparison">ğŸ”„ Compare All</button>
                <button class="mode-tab" data-mode="builder">âœï¸ Build Your Own</button>
            </div>
        </nav>
        
        <!-- SINGLE SCENARIO MODE -->
        <div class="mode-content active" data-mode="single">
            <section class="scenario-section">
                <div class="section-header">
                    <h2>Choose Your Scenario</h2>
                    <p>Select a real-world situation to explore how privacy noise affects critical decisions</p>
                </div>
                
                <div class="scenario-cards">
                    <div class="scenario-card active" data-scenario="school" onclick="selectScenario('school')">
                        <span class="scenario-emoji">ğŸ«</span>
                        <h3>School Funding Decision</h3>
                        <p>Does your district qualify for $2.4M in Title I federal education funding?</p>
                        <div class="scenario-details">
                            <div class="scenario-detail-row"><span>Threshold</span><span>1,200 children</span></div>
                            <div class="scenario-detail-row"><span>True Value</span><span>1,247 children</span></div>
                            <div class="scenario-detail-row"><span>Stakes</span><span>$2.4M annually</span></div>
                        </div>
                        <a href="html/scenario-school.html" class="btn btn-ghost" style="margin-top: 16px; width: 100%;" onclick="event.stopPropagation();">View Full Analysis â†’</a>
                    </div>
                    <div class="scenario-card" data-scenario="hospital" onclick="selectScenario('hospital')">
                        <span class="scenario-emoji">ğŸ¥</span>
                        <h3>Rural Clinic Placement</h3>
                        <p>Should this rural area receive approval for a new health clinic?</p>
                        <div class="scenario-details">
                            <div class="scenario-detail-row"><span>Threshold</span><span>5,000 residents</span></div>
                            <div class="scenario-detail-row"><span>True Value</span><span>4,850 residents</span></div>
                            <div class="scenario-detail-row"><span>Stakes</span><span>Healthcare access</span></div>
                        </div>
                        <a href="html/scenario-hospital.html" class="btn btn-ghost" style="margin-top: 16px; width: 100%;" onclick="event.stopPropagation();">View Full Analysis â†’</a>
                    </div>
                    <div class="scenario-card" data-scenario="redistrict" onclick="selectScenario('redistrict')">
                        <span class="scenario-emoji">ğŸ—³ï¸</span>
                        <h3>Congressional Redistricting</h3>
                        <p>Does this region justify an additional congressional representative?</p>
                        <div class="scenario-details">
                            <div class="scenario-detail-row"><span>Threshold</span><span>700,000 people</span></div>
                            <div class="scenario-detail-row"><span>True Value</span><span>710,000 people</span></div>
                            <div class="scenario-detail-row"><span>Stakes</span><span>Political power</span></div>
                        </div>
                        <a href="html/scenario-redistrict.html" class="btn btn-ghost" style="margin-top: 16px; width: 100%;" onclick="event.stopPropagation();">View Full Analysis â†’</a>
                    </div>
                </div>
            </section>
            
            <!-- Main Simulator -->
            <section class="simulator-section">
                <div class="simulator-header">
                    <h2 id="simTitle">ğŸ”¬ Privacy vs. Accuracy Simulator</h2>
                    <p id="simSubtitle">Drag the slider to see how privacy settings change your data and decision confidence</p>
                </div>
                
                <div class="context-banner">
                    <h4>ğŸ“‹ Current Scenario Context</h4>
                    <p id="contextText">Title I funding requires school districts to have at least 1,200 children from low-income families to qualify.</p>
                </div>
                
                <div class="simulator-layout">
                    <div class="control-panel">
                        <h3>âš™ï¸ Data Controls</h3>
                        <div class="data-display">
                            <div class="data-row"><span class="data-label">True (Hidden) Value</span><span class="data-value" id="trueValue">1,247</span></div>
                            <div class="data-row"><span class="data-label">Decision Threshold</span><span class="data-value" id="threshold">1,200</span></div>
                            <div class="data-row"><span class="data-label">Published (Noisy) Value</span><span class="data-value" id="noisyValue" style="color: var(--accent-gold);">â€”</span></div>
                            <div class="data-row"><span class="data-label">Uncertainty Range</span><span class="data-value" id="rangeValue" style="color: var(--accent-teal);">â€”</span></div>
                        </div>
                        
                        <div class="slider-container">
                            <div class="slider-header">
                                <label>Privacy Level (Epsilon Îµ)</label>
                                <span class="epsilon-badge" id="epsilonBadge">Îµ = 1.0</span>
                            </div>
                            <div class="slider-track">
                                <input type="range" id="epsilonSlider" min="0.1" max="5" step="0.1" value="1.0">
                            </div>
                            <div class="slider-labels"><span>ğŸ”’ Max Privacy</span><span>ğŸ“Š Max Accuracy</span></div>
                        </div>
                        
                        <div class="stats-grid" style="margin-top: 24px;">
                            <div class="stat-box"><div class="stat-value" id="errorPercent">â€”</div><div class="stat-label">Error %</div></div>
                            <div class="stat-box"><div class="stat-value" id="noiseScale">â€”</div><div class="stat-label">Noise Scale</div></div>
                            <div class="stat-box"><div class="stat-value" id="confidence">â€”</div><div class="stat-label">Confidence</div></div>
                        </div>
                    </div>
                    
                    <div class="viz-panel">
                        <div class="viz-card">
                            <h4>ğŸ“Š Threshold Visualization</h4>
                            <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 16px;">The <span style="color: var(--accent-coral);">red line</span> is the threshold. The <span style="color: var(--accent-teal);">teal band</span> shows uncertainty. The <span style="color: var(--accent-gold);">gold dot</span> is the reported value.</p>
                            <div class="threshold-viz">
                                <div class="threshold-bar">
                                    <div class="uncertainty-range" id="uncertaintyRange"></div>
                                    <div class="threshold-line" id="thresholdLine"><span class="threshold-label" id="thresholdLabel">Threshold: 1,200</span></div>
                                    <div class="value-marker" id="valueMarker"><span class="value-label" id="valueLabel">1,247</span><div class="value-dot"></div></div>
                                </div>
                            </div>
                            <div class="range-labels"><span id="rangeLow">Low: â€”</span><span id="rangeHigh">High: â€”</span></div>
                        </div>
                        
                        <div class="viz-card">
                            <h4>âš–ï¸ Your Decision</h4>
                            <div class="decision-outcome uncertain" id="decisionOutcome">
                                <div class="decision-badge">â³ Adjust the slider above</div>
                                <p>Move the privacy slider to see how it affects your decision</p>
                            </div>
                        </div>
                        
                        <div class="insight-box">
                            <h5>ğŸ’¡ What This Means</h5>
                            <p id="insightText">The privacy parameter Îµ (epsilon) controls the tradeoff. Lower Îµ = stronger privacy but more noise.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Advanced Analytics Preview -->
            <section class="advanced-charts-section">
                <div class="charts-header">
                    <h2>ğŸ“ˆ Advanced Analytics</h2>
                    <a href="html/analytics.html" class="btn btn-primary" target="_blank">ğŸ”¬ Open Full Dashboard â†’</a>
                </div>
                
                <div class="analytics-embed">
                    <iframe id="analyticsFrame" src="html/analytics.html" style="width: 100%; height: 600px; border: none; border-radius: 16px;"></iframe>
                </div>
                
                <p style="text-align: center; color: var(--text-muted); margin-top: var(--space-md); font-size: 0.9rem;">
                    ğŸ“Š 12 interactive charts including distribution, CDF, sensitivity analysis, and cross-scenario comparison. 
                    <a href="html/analytics.html" target="_blank" style="color: var(--accent-gold);">Open in new tab</a> for full experience.
                </p>
            </section>
            
            <!-- Flow Diagram -->
            <section class="flow-diagram-section">
                <div class="flow-diagram-header">
                    <h2>ğŸ”— DP Decision Pipeline</h2>
                    <span class="badge badge--violet">Interactive Flow</span>
                </div>
                <div class="flow-diagram-container">
                    <div class="flow-pipeline" id="flowPipeline"></div>
                </div>
                <div class="trace-panel">
                    <div class="trace-header"><span class="trace-icon">ğŸ”</span><span class="trace-title">Trace View</span></div>
                    <div class="trace-content" id="traceContent"><p>Adjust the epsilon slider to see how data flows through the DP pipeline...</p></div>
                </div>
            </section>
        </div>
        
        <!-- COMPARISON MODE -->
        <div class="mode-content" data-mode="comparison">
            <section class="comparison-section">
                <div class="comparison-header">
                    <h2>ğŸ”„ Multi-Scenario Comparison</h2>
                    <p style="color: var(--text-secondary);">Compare how DP affects different civic decisions at the current Îµ setting</p>
                </div>
                
                <div class="comparison-table-wrapper">
                    <table class="comparison-summary-table">
                        <thead><tr><th></th><th>Scenario</th><th>True Value</th><th>Threshold</th><th>Error</th><th>Flip Prob</th><th>Stakes</th></tr></thead>
                        <tbody id="comparisonTableBody"></tbody>
                    </table>
                </div>
                
                <div class="chart-card" style="margin-top: var(--space-xl);">
                    <h4>ğŸ“ˆ Wrong Decision Probability by Scenario</h4>
                    <p class="chart-description">How the probability of a wrong decision varies with Îµ for each scenario.</p>
                    <div class="comparison-chart-container"><canvas id="comparisonChart"></canvas></div>
                </div>
            </section>
        </div>
        
        <!-- STORY BUILDER MODE -->
        <div class="mode-content" data-mode="builder">
            <section class="story-builder-section">
                <div class="story-builder-header">
                    <h2>âœï¸ Build Your Own Scenario</h2>
                    <span class="story-count-badge" id="storyCountBadge">0/10 scenarios</span>
                </div>
                
                <form class="story-builder-form" id="storyBuilderForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Scenario Name *</label>
                            <input type="text" id="storyName" placeholder="e.g., Community Library Funding" required>
                        </div>
                        <div class="form-group">
                            <label>Icon</label>
                            <input type="hidden" id="storyIcon" value="ğŸ“Š">
                            <div class="icon-selector" id="iconSelector"></div>
                        </div>
                        <div class="form-group full-width">
                            <label>Description</label>
                            <textarea id="storyDescription" placeholder="Describe the scenario and its stakes..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>True Value *</label>
                            <input type="number" id="storyTrueValue" placeholder="e.g., 1247" required>
                            <span class="form-hint">The actual population/count</span>
                        </div>
                        <div class="form-group">
                            <label>Threshold *</label>
                            <input type="number" id="storyThreshold" placeholder="e.g., 1200" required>
                            <span class="form-hint">The cutoff for approval/denial</span>
                        </div>
                        <div class="form-group">
                            <label>Sensitivity</label>
                            <input type="number" id="storySensitivity" placeholder="1" value="1" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>Category</label>
                            <select id="storyCategory">
                                <option value="funding">ğŸ’° Funding</option>
                                <option value="health">â¤ï¸ Health</option>
                                <option value="democracy">ğŸ—³ï¸ Democracy</option>
                                <option value="infrastructure">ğŸ—ï¸ Infrastructure</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Stakes Description</label>
                            <input type="text" id="storyStakes" placeholder="e.g., $500K annually">
                        </div>
                        <div class="form-group full-width">
                            <label>Optional: Upload CSV Data</label>
                            <div class="csv-upload-area" id="csvUploadArea">
                                <div class="csv-upload-icon">ğŸ“„</div>
                                <p class="csv-upload-text">Drag & drop a CSV file or click to browse</p>
                                <p class="csv-upload-hint">Format: epsilon, true_value, noisy_value, threshold, decision, flip_flag</p>
                            </div>
                            <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
                            <div class="csv-file-info" id="csvFileInfo" style="display: none;">
                                <span>ğŸ“„</span><span class="csv-file-name" id="csvFileName"></span>
                                <button type="button" class="csv-remove-btn" onclick="removeCsvFile()">Ã—</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-ghost" onclick="this.form.reset()">Clear</button>
                        <button type="submit" class="btn btn-primary">Create Scenario</button>
                    </div>
                </form>
                
                <h3 style="margin: var(--space-xl) 0 var(--space-lg); color: var(--text-bright);">Your Custom Scenarios</h3>
                <div class="user-stories-grid" id="userStoriesGrid">
                    <div class="empty-stories"><div class="empty-stories-icon">ğŸ“</div><p>No custom scenarios yet. Create your first one above!</p></div>
                </div>
            </section>
        </div>
        
        <!-- Explainer Section -->
        <section class="explainer-section">
            <div class="explainer-header">
                <h2>ğŸ“ How Differential Privacy Works</h2>
                <p style="color: var(--text-secondary);">Understanding the mechanism behind the tradeoff</p>
            </div>
            <div class="step-timeline">
                <div class="timeline-step"><div class="step-number">1</div><div class="step-content"><h4>True Data Collection</h4><p>The Census Bureau collects individual responses from every household.</p><div class="step-example"><div class="step-example-label">Example</div><code>Household #4521: 4 people, ages 42, 40, 15, 12</code></div></div></div>
                <div class="timeline-step"><div class="step-number">2</div><div class="step-content"><h4>Noise Injection</h4><p>Random noise drawn from a Laplace distribution is added. Amount controlled by Îµ.</p><div class="step-example"><div class="step-example-label">Formula</div><code>Published = True + Laplace(0, sensitivity/Îµ)</code></div></div></div>
                <div class="timeline-step"><div class="step-number">3</div><div class="step-content"><h4>Publication & Use</h4><p>Noisy data is released publicly. Decision-makers use this dataâ€”often unaware of uncertainty.</p><div class="step-example"><div class="step-example-label">Reality</div><code>True: 1,247 â†’ Published: 1,218 â†’ Decision: DENIED</code></div></div></div>
                <div class="timeline-step"><div class="step-number">4</div><div class="step-content"><h4>Threshold Decisions</h4><p>When published values are compared against thresholds, noise can flip outcomes.</p><div class="step-example"><div class="step-example-label">Impact</div><code>$2.4M in funding lost due to statistical noise</code></div></div></div>
            </div>
        </section>
        
        <!-- Consequences Section -->
        <section class="consequences-section">
            <div class="section-header"><h2>Who Wins and Who Loses?</h2><p>The uneven impact of privacy-accuracy tradeoffs</p></div>
            <div class="consequences-grid">
                <div class="consequence-card winners">
                    <h3>âœ… Benefits From DP</h3>
                    <ul class="consequence-list">
                        <li>Individuals in small, identifiable groups gain privacy protection</li>
                        <li>Vulnerable populations face reduced re-identification risk</li>
                        <li>Large metropolitan areas experience minimal data distortion</li>
                        <li>Privacy researchers gain a mathematically rigorous framework</li>
                    </ul>
                </div>
                <div class="consequence-card losers">
                    <h3>âŒ Harmed By DP</h3>
                    <ul class="consequence-list">
                        <li>Small communities face proportionally larger errors</li>
                        <li>Rural areas may lose eligibility for health programs</li>
                        <li>School districts near thresholds face funding uncertainty</li>
                        <li>Minority populations may become statistically invisible</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <!-- Footer -->
        <footer class="footer-cta">
            <h2>Explore the Full Research</h2>
            <p>This interactive explorer accompanies academic research on the civic implications of differential privacy.</p>
            <div class="cta-buttons">
                <button class="btn btn-primary" onclick="resetAndExplore()">ğŸ”¬ Try Another Scenario</button>
                <button class="btn btn-secondary" onclick="scrollToTop()">â†‘ Back to Top</button>
            </div>
        </footer>
    </div>
    
    <!-- Scripts -->
    <script src="js/scenario-data.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/comparison.js"></script>
    <script src="js/story-builder.js"></script>
    <script src="js/flow-diagram.js"></script>
</body>
</html>
